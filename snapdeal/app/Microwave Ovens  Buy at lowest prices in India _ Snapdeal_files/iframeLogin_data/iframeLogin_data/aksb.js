/*
Copyright 2010 Google Inc.
Copyright 2014 Akamai Technolgies

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

See the source code here:
     http://code.google.com/p/episodes/
*/

(function(b){b.parent!==b&&void 0==b.AKSB&&(b=b.parent);var h=b.document;"undefined"===typeof b.AKSB&&(b.AKSB={});var a=b.AKSB;if(void 0!=a.prof&&!0===a.prof.origin&&("number"!==typeof a.prof.beaconrate&&(a.prof.beaconrate=10),parseInt(a.prof.beaconrate,10)<=100*Math.random()))return;a.q=a.q||[];a.targetOrigin=h.location.protocol+"//"+h.location.hostname;a.testObject=a.testObject||"AkamaiSiteBeaconTestObject0123456789.txt";a.autorun="undefined"!==typeof a.autorun?a.autorun:!0;a.version||(a.version=
1,a.init=function(){a.bDone=!1;a.marks={};a.measures={};a.starts={};a.getClientProf();a.findStartTime();a.addEventListener("DOMContentLoaded",a.onready,!1);a.addEventListener("load",a.onload,!1);"complete"===h.readyState&&(a.onloadHasFired=!0,window.setTimeout(a.onload,1));a.processQ()},a.processQ=function(){for(var c=a.q.length,b=0;b<c;b++){var d=a.q[b],l=d[0];"mark"===l?a.mark(d[1],d[2]):"measure"===l?a.measure(d[1],d[2],d[3]):"done"===l&&a.done(d[1])}},a.getClientProf=function(){a.prof=a.prof||
{};a.prof.beaconUrl=a.prof.beaconUrl||("https:"===h.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b";a.prof.ua=escape(b.navigator.userAgent);a.prof.plat=escape(b.navigator.platform);a.prof.uri=escape(h.location.protocol.toLowerCase()+"//"+h.location.hostname.toLowerCase()+h.location.pathname);var c=b.navigator.connection||b.navigator.mozConnection||b.navigator.webkitConnection,f="",d="";c&&"number"===typeof c.type?c.type==c.WIFI?(f="wifi",d=7E6):c.type==c.CELL_2G?
(f="cellular",d=384):c.type==c.CELL_3G?(f="cellular",d=42E3):c.type==c.CELL_4G?(f="cellular",d=1E5):c.type==c.ETHERNET?(f="ethernet",d=1E7):c.type==c.NONE?(f="none",d=0):f="unknown":c&&"string"===typeof c.type&&(f=c.type,c.downlinkMax&&(d=Math.round(1E3*c.downlinkMax)));a.prof.connType=escape(f);a.prof.connBandwidth=d;a.prof.pageViz=h.visibilityState||h.webkitVisibilityState||h.mozVisibilityState||h.msVisibilityState;a.prof.feo="undefined"!==typeof b.aFeoApplied?!0:!1;a.prof.qryTrunc=""!==h.location.search;
!a.prof.pct||parseInt(a.prof.pct,10)<=100*Math.random()||void 0===a.prof.clientip||(a.prof.ipv6?(c=a.prof.clientip.split(":"),c=(""==c[0]?"":parseInt(c[0],16).toString(32))+"z"+(""==c[1]?"":parseInt(c[1],16).toString(32))+"z"+(""==c[2]?"":parseInt(c[2],16).toString(32)),a.prof.beaconUrl=("https:"===h.location.protocol?"https:":"http:")+"//j"+c+"-ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b"):(c=a.prof.clientip.split("."),c=("00000000"+(256*(256*(256*+c[0]+ +c[1])+ +c[2])+0).toString(16)).slice(-8),
a.prof.beaconUrl=("https:"===h.location.protocol?"https:":"http:")+"//i"+c+"-ds-aksb-a.akamaihd.net/2/"+a.prof.custid+"/b"))},a.mark=function(c,b){c&&(a.marks[c]=parseInt(b||(new Date).getTime(),10),"firstbyte"===c?a.measure("t_fb","starttime","firstbyte"):"onload"===c?a.measure("t_onload","starttime","onload"):"done"===c&&a.measure("t_plt","starttime","done"))},a.measure=function(c,b,d){if(c){if("undefined"===typeof b)b="number"===typeof a.marks[c]?a.marks[c]:(new Date).getTime();else if("number"===
typeof a.marks[b])b=a.marks[b];else if("number"!==typeof b)return;if("undefined"===typeof d)d=(new Date).getTime();else if("number"===typeof a.marks[d])d=a.marks[d];else if("number"!==typeof d)return;a.starts[c]=parseInt(b,10);a.measures[c]=parseInt(d-b,10)}},a.done=function(c){a.mark("done");var f=function(){a.bDone=!0;a.autorun&&a.sendBeacon();"function"===typeof c&&c()};if(a.prof.navTimingSupported){var d=a.getNavTimingAPI(),l=d.navigation,g=d.timing,m=function(){if(l&&(0===l.type||1===l.type)&&
g&&0<g.loadEventEnd){for(var c in g)a.mark(c,g[c]);a.measure("dE","domainLookupStart","domainLookupEnd");a.measure("cS","domainLookupStart","connectStart");g.secureConnectionStart&&a.measure("sS","domainLookupStart","secureConnectionStart");a.measure("cE","domainLookupStart","connectEnd");a.measure("rqS","domainLookupStart","requestStart");a.measure("rsS","domainLookupStart","responseStart");a.measure("rsE","domainLookupStart","responseEnd");g.msFirstPaint?a.measure("fp","navigationStart","msFirstPaint"):
"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")&&a.measure("fp","domainLookupStart",Math.round(1E3*b.chrome.loadTimes().firstPaintTime));a.measure("dl","domainLookupStart","domLoading");a.measure("di","domainLookupStart","domInteractive");a.measure("dlS","domainLookupStart","domContentLoadedEventStart");a.measure("dlE","domainLookupStart","domContentLoadedEventEnd");a.measure("dc","domainLookupStart","domComplete");a.measure("leS","domainLookupStart","loadEventStart");a.measure("leE",
"domainLookupStart","loadEventEnd");f()}else 0>=g.loadEventEnd&&setTimeout(m,100)};m()}else f()},a.aksbVersion=function(){return""+(void 0===a.prof.blver?0:a.prof.blver)+":"+(void 0===a.version?0:a.version)},a.sendBeacon=function(c,b){c=c||a.prof.beaconUrl;var d="";a.bf=a.bitField();a.createBitField();var l={dE:a.measures.dE,cS:a.measures.cS,cE:a.measures.cE,rqS:a.measures.rqS,rsS:"undefined"!==typeof a.measures.rsS?a.measures.rsS:a.measures.t_fb,rsE:a.measures.rsE,sS:a.measures.sS,dl:a.measures.dl,
di:a.measures.di,fp:a.measures.fp,dlS:a.measures.dlS,dlE:"undefined"!==typeof a.measures.dlE?a.measures.dlE:a.measures.t_onready,dc:a.measures.dc,leS:"undefined"!==typeof a.measures.leS?a.measures.leS:a.measures.t_onload,leE:"undefined"!==typeof a.measures.leE?a.measures.leE:a.measures.t_plt,to:a.measures.to,ol:a.prof.originlat,cr:a.prof.clientrtt,mt:a.prof.connType,mb:a.prof.connBandwidth,b:a.bf.get(),u:a.prof.uri,ua:a.prof.ua,pl:a.prof.plat,us:a.prof.ustr,gh:a.prof.ghostip,t:a.prof.token,rid:a.prof.requestid,
akM:a.prof.akM,akN:a.prof.akN,vc:a.aksbVersion()},g;for(g in l)d+="&"+escape(g)+"="+("undefined"===typeof l[g]?"":l[g]);if(d){d=d.substring(1);if(b)for(var m in b)b.hasOwnProperty(m)&&(d+="&"+escape(m)+"="+escape(b[m]));a.bf.get();l=new Image;l.src=c+"?"+d;return l.src}return""},a.bitField=function(a){var b=Math.abs(a);a=function(){};a.prototype.set=function(a){return this.hasbit(a)?b:b|=a};a.prototype.hasbit=function(a){return a>b?0:b&a};a.prototype.get=function(){return b};return new a},a.createBitField=
function(){"nt"===a.prof.src&&a.bf.set(1);"js"===a.prof.src&&a.bf.set(2);"gtb"===a.prof.src&&a.bf.set(8);var c=a.prof.protocol;void 0!==c&&("h2"==c.slice(0,2)?a.bf.set(131072):"spdy"==c.slice(0,4)&&a.bf.set(64));a.prof.ipv6&&a.bf.set(16);a.prof.feo&&a.bf.set(32);"hidden"===a.prof.pageViz&&a.bf.set(128);"visible"===a.prof.pageViz&&a.bf.set(256);"prerendered"===a.prof.pageViz&&a.bf.set(512);a.prof.qryTrunc&&a.bf.set(2048);!0===a.prof.origin&&a.bf.set(4096);!0===a.onloadHasFired&&a.bf.set(8192);b.performance&&
(b.performance.getEntries||b.performance.webkitGetEntries)||a.bf.set(16384)},a.findStartTime=function(){a.processQ();var b=a.findStartWebTiming()||a.findStartGToolbar();!b&&a.marks.firstbyte&&(b=a.marks.firstbyte,a.prof.src="js");b&&a.mark("starttime",b)},a.findStartWebTiming=function(){var b=void 0,f=a.getNavTimingAPI();if("undefined"!==typeof f&&"undefined"!==typeof f.timing&&"undefined"!==typeof f.timing.navigationStart)a.prof.navTimingSupported=!0,b=a.prof.ua.match(/Firefox\/[78]\./i)?f.timing.unloadEventStart||
f.timing.fetchStart:f.timing.navigationStart,a.prof.src="nt";else if(a.prof.xhrtest){var d=a.newXHR();if(d){a.mark("testobj-start");d.open("get",("https:"===document.location.protocol?"https:":"http:")+"//"+h.location.hostname+"/"+a.testObject,!0);var l=setTimeout(function(){d.abort()},1E4);d.onreadystatechange=function(){4===d.readyState&&200<=d.status&&500>d.status&&(clearTimeout(l),a.measure("to","testobj-start"))};d.send(null)}}return b},a.findStartGToolbar=function(){var c=void 0;"undefined"!==
typeof b.external&&"undefined"!==typeof b.external.pageT?c=(new Date).getTime()-b.external.pageT:"undefined"!==typeof b.gtbExternal&&"undefined"!==typeof b.gtbExternal.pageT?c=(new Date).getTime()-window.gtbExternal.pageT():"undefined"!==typeof b.chrome&&"undefined"!==typeof b.chrome.csi&&(c=(new Date).getTime()-b.chrome.csi().pageT);c&&(a.prof.src="gtb");return c},a.onready=function(b){a.mark("onready",(new Date).getTime());a.measure("t_onready","starttime","onready")},a.onload=function(b){a.mark("onload",
(new Date).getTime());a.autorun&&a.done()},a.addEventListener=function(a,f,d){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,f);if(b.addEventListener)return b.addEventListener(a,f,d)},a.newXHR=function(){a.axStr="unk";if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)if("unk"===a.axStr){for(var b=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],f=0,d=b.length;f<d;f++)try{var l=
new ActiveXObject(b[f]);a.axStr=b[f];return l}catch(g){}a.axStr="none"}else if("none"!==a.axStr)return new ActiveXObject(a.axStr);return null},a.getNavTimingAPI=function(){return b.performance||b.mozPerformance||b.msPerformance||b.webkitPerformance},a.init())})(window);
(function(b){function h(){this.data={};this.value=[]}b.parent!==b&&void 0==b.RT&&(b=b.parent);var a=b.document;"undefined"===typeof b.RT&&(b.RT={});var c=b.RT;c.version||"undefined"===typeof b.AKSB.version||void 0===Object.keys||(c.version="0.2",c.init=function(){"complete"===a.readyState?window.setTimeout(c.getW3CTimings,1):c.addEventListener("load",c.getW3CTimings,!1)},c.getW3CTimings=function(){var f=new h,d=c.getResourceTimingAPI(),l={},g=0;if("all"in b.document)for(var m=b.document.all,k=0;k<
m.length;k++){var n=m[k];if("LINK"===n.tagName&&"href"in n){if("http"===n.href.substr(0,4).toLowerCase()&&(l[n.href]=1,1E3<g++))break}else if("src"in n&&"http"===n.src.substr(0,4).toLowerCase()&&(l[n.src]=1,1E3<g++))break}if(d)for(k in d)"undefined"!==typeof d[k].duration&&(delete l[d[k].name],f.insert(d[k].name,[Math.round(d[k].redirectStart),Math.round(d[k].redirectEnd),Math.round(d[k].fetchStart),Math.round(d[k].domainLookupStart),Math.round(d[k].domainLookupEnd),Math.round(d[k].connectStart),
Math.round(d[k].connectEnd),Math.round(d[k].secureConnectionStart),Math.round(d[k].requestStart),Math.round(d[k].responseStart),Math.round(d[k].responseEnd),Math.round(d[k].duration),d[k].initiatorType,d[k].nextHopProtocol,d[k].transferSize,d[k].encodedBodySize,d[k].decodedBodySize]));for(res in l)f.insert(res,[]);c.radtree=f;c.baseurl=escape(a.location.protocol.toLowerCase()+"//"+a.location.hostname.toLowerCase()+a.location.pathname);var p=function(a){var d=new XMLHttpRequest;d.open("POST",("https:"===
b.document.location.protocol?"https:":"http:")+"//ds-aksb-a.akamaihd.net/RRT",!0);d.send(JSON.stringify([a,c.radtree.data,b.AKSB.prof.requestid,b.AKSB.prof.ghostip,b.AKSB.bf.get(),b.AKSB.prof.custid,b.AKSB.prof.ustr,b.AKSB.prof.originlat,b.AKSB.prof.clientrtt,b.AKSB.prof.ua,b.AKSB.prof.plat,b.AKSB.prof.connType,b.AKSB.prof.connBandwidth,b.AKSB.aksbVersion()]))};if(b.performance&&b.performance.timing){var e=b.performance.timing,q=function(){if(0<e.loadEventEnd){var a=[e.domainLookupEnd-e.domainLookupStart,
e.connectStart-e.domainLookupStart,e.connectEnd-e.domainLookupStart,e.secureConnectionStart?e.secureConnectionStart-e.domainLookupStart:null,e.requestStart-e.domainLookupStart,e.responseStart-e.domainLookupStart,e.responseEnd-e.domainLookupStart,e.domLoading-e.domainLookupStart,e.domInteractive-e.domainLookupStart,e.msFirstPaint?e.msFirstPaint-e.navigationStart:"undefined"!==typeof b.chrome&&b.chrome.hasOwnProperty("loadTimes")?Math.round(1E3*b.chrome.loadTimes().firstPaintTime)-e.domainLookupStart:
null,e.domContentLoadedEventStart-e.domainLookupStart,e.domContentLoadedEventEnd-e.domainLookupStart,e.domComplete-e.domainLookupStart,e.loadEventStart-e.domainLookupStart,e.loadEventEnd-e.domainLookupStart],d={};d[c.baseurl]=a;p(d)}else 0>=e.loadEventEnd&&setTimeout(q,100)};q()}else{var r=function(){if("AKSB"in b&&"measures"in b.AKSB&&"t_plt"in b.AKSB.measures){var a={};a[c.baseurl]=[null,null,null,0,null,null,null,null,null,null,null,null,null,b.AKSB.measures.t_onload,b.AKSB.measures.t_plt];p(a)}else setTimeout(r,
100)};r()}},c.addEventListener=function(a,d,c){if("undefined"!==typeof b.attachEvent)return b.attachEvent("on"+a,d);if(b.addEventListener)return b.addEventListener(a,d,c)},c.getResourceTimingAPI=function(){if("performance"in b){if("getEntriesByType"in b.performance)return b.performance.getEntriesByType("resource");if("webkitGetEntriesByType"in b.performance)return b.performance.webkitGetEntriesByType("resource")}return null},h.prototype.insert=function(a,b){for(var c=this.data;a;){var g=this.get_prefix(a,
Object.keys(c)),m=g[0],g=g[1];if(!m||"string"!==typeof m||"string"!==typeof g)break;var k=m.length;if(m!==g){var n=g.slice(k,g.length),h=c[g];h===this.value&&(h=JSON.parse(JSON.stringify(h)));c[m]={};c[m][n]=h;delete c[g]}else c[m]===this.value&&(c[m]=JSON.parse(JSON.stringify(this.value)));a=a.slice(k,a.length);c=c[m]}c[a]=a?b:null;return!0},h.prototype.get_prefix=function(a,b){function c(a,b){if(""===b)return!0;if(null==a||null==b)return!1;a=String(a);b=String(b);return a.length>=b.length&&a.slice(0,
b.length)===b}b.sort(function(a,b){return a.length<b.length?-1:a.length>b.length?1:0}).reverse;if("undefined"!==typeof a){wc=a[0];for(var g in b)if(c(b[g],wc))for(var h=a.length;1<=h;h--)if(c(b[g],a.slice(0,h)))return[a.slice(0,h),b[g]]}return["",null]},"https:"===a.location.protocol||!(0<=b.document.location.search.search("akamai-rum-rt=on"))&&10<=100*Math.random()||c.init())})(window);
